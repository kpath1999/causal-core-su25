
==================================================
starting meta-rl teacher-student training
   task: pushing
   meta-episodes: 10
   student training steps: 10000
==================================================
INFO:root:Loaded student PPO from ppo_pushing_sb3/final_model.zip

==================================================
initial evaluation
==================================================

evaluating student performance (5 episodes)...
episode 1: length=27, reward=-0.773, success=True
episode 2: length=27, reward=-0.773, success=True
episode 3: length=27, reward=-0.773, success=True
performance summary:
success rate: 1.000 (5/5)
average reward: -0.773
average episode length: 27.0
initial student success rate: 1.000
Computing teacher state (CM scores for all interventions)...
Processing intervention 1/6: goal
IntervenedCausalWorld created with goal intervention
Evaluating CM score for goal intervention...
Reset #1: goal intervention applied (success: True)
episode 1: 501 steps, reward: 3.078
Reset #2: goal intervention applied (success: True)
episode 2: 501 steps, reward: 0.039
Reset #3: goal intervention applied (success: True)
episode 3: 501 steps, reward: 1.888
total data points collected: 2505
average episode length: 501.0
average episode reward: 1.207
termination reasons: ['max_length', 'max_length', 'max_length', 'max_length', 'max_length']
success rate: 0/5
meta_teacher_student.py:208: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:230.)
  states = torch.tensor([d[0] for d in data], dtype=torch.float32).to(device)
tensor shapes - states: torch.Size([2505, 56]), actions: torch.Size([2505, 9])
Creating ensembles (obs_dim=56, act_dim=9, hidden_dim=64)
Training transition models...
Transition model losses: ['7.4553', '7.8204', '7.3470', '7.0077', '7.6039']
Training reward models...
Reward model losses: ['0.3503', '0.1899', '0.0223', '0.9518', '0.0046']
Training state VAE models...
State VAE losses: ['304193.2913', '344794.3100', '346621.1875', '372267.5675', '308904.4988']
Training action VAE models...
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
Action VAE losses: ['7822.5591', '15760.2344', '6659.2900', '12277.5332', '7726.9502']
CM score components:
transition disagreement: 0.3879
reward disagreement: 0.3452
state disagreement: 1.1238
action disagreement: nan
total CM score: nan
goal is complete. CM score: nan
Processing intervention 2/6: mass
IntervenedCausalWorld created with mass intervention
Evaluating CM score for mass intervention...
Reset #1: mass intervention applied (success: True)
episode 1: 501 steps, reward: 4.514
Reset #2: mass intervention applied (success: True)
episode 2: 501 steps, reward: 4.913
Reset #3: mass intervention applied (success: True)
episode 3: 501 steps, reward: 4.497
total data points collected: 2505
average episode length: 501.0
average episode reward: 4.392
termination reasons: ['success', 'success', 'success', 'success', 'max_length']
success rate: 4/5
tensor shapes - states: torch.Size([2505, 56]), actions: torch.Size([2505, 9])
Creating ensembles (obs_dim=56, act_dim=9, hidden_dim=64)
Training transition models...
Transition model losses: ['7.2569', '7.0996', '7.8747', '7.4233', '7.5751']
Training reward models...
Reward model losses: ['0.0097', '0.2679', '0.0024', '0.0143', '0.0034']
Training state VAE models...
State VAE losses: ['325714.7512', '243975.6331', '392524.9788', '353827.3700', '191143.2462']
Training action VAE models...
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
Action VAE losses: ['10077.1250', '11400.8604', '12417.0020', '11872.5664', '11216.8086']
CM score components:
transition disagreement: 0.4409
reward disagreement: 0.0751
state disagreement: 1.1728
action disagreement: nan
total CM score: nan
mass is complete. CM score: nan
Processing intervention 3/6: friction
IntervenedCausalWorld created with friction intervention
Evaluating CM score for friction intervention...
Reset #1: friction intervention applied (success: True)
episode 1: 501 steps, reward: 4.469
Reset #2: friction intervention applied (success: True)
episode 2: 501 steps, reward: 3.387
Reset #3: friction intervention applied (success: True)
episode 3: 501 steps, reward: 3.374
total data points collected: 2505
average episode length: 501.0
average episode reward: 4.033
termination reasons: ['success', 'max_length', 'max_length', 'success', 'success']
success rate: 3/5
tensor shapes - states: torch.Size([2505, 56]), actions: torch.Size([2505, 9])
Creating ensembles (obs_dim=56, act_dim=9, hidden_dim=64)
Training transition models...
Transition model losses: ['7.2410', '6.5319', '7.4404', '7.3469', '7.3709']
Training reward models...
Reward model losses: ['0.0963', '0.0046', '0.1233', '0.0216', '1.1432']
Training state VAE models...
State VAE losses: ['287441.1450', '286546.9487', '367544.0625', '330026.0775', '473853.2162']
Training action VAE models...
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
Action VAE losses: ['9602.8740', '15282.2041', '9083.0508', '11005.3398', '12132.0693']
CM score components:
transition disagreement: 0.4029
reward disagreement: 0.4061
state disagreement: 1.1964
action disagreement: nan
total CM score: nan
friction is complete. CM score: nan
Processing intervention 4/6: visual
IntervenedCausalWorld created with visual intervention
Evaluating CM score for visual intervention...
Reset #1: visual intervention applied (success: True)
episode 1: 501 steps, reward: 3.394
Reset #2: visual intervention applied (success: True)
episode 2: 501 steps, reward: 3.394
Reset #3: visual intervention applied (success: True)
episode 3: 501 steps, reward: 3.394
total data points collected: 2505
average episode length: 501.0
average episode reward: 3.394
termination reasons: ['max_length', 'max_length', 'max_length', 'max_length', 'max_length']
success rate: 0/5
tensor shapes - states: torch.Size([2505, 56]), actions: torch.Size([2505, 9])
Creating ensembles (obs_dim=56, act_dim=9, hidden_dim=64)
Training transition models...
Transition model losses: ['6.7867', '7.9149', '7.0063', '7.8457', '7.7625']
Training reward models...
Reward model losses: ['0.0087', '0.0083', '0.0035', '0.7877', '0.1858']
Training state VAE models...
State VAE losses: ['330389.6238', '318453.1875', '220934.3112', '349964.8100', '416232.8100']
Training action VAE models...
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
Action VAE losses: ['10502.7529', '12158.2686', '11651.8223', '10389.3340', '8963.3174']
CM score components:
transition disagreement: 0.4458
reward disagreement: 0.2764
state disagreement: 1.1849
action disagreement: nan
total CM score: nan
visual is complete. CM score: nan
Processing intervention 5/6: pose
IntervenedCausalWorld created with pose intervention
Evaluating CM score for pose intervention...
Reset #1: pose intervention applied (success: True)
episode 1: 501 steps, reward: 4.548
Reset #2: pose intervention applied (success: True)
episode 2: 501 steps, reward: 0.759
Reset #3: pose intervention applied (success: True)
episode 3: 501 steps, reward: -1.746
total data points collected: 2505
average episode length: 501.0
average episode reward: -0.003
termination reasons: ['max_length', 'max_length', 'max_length', 'max_length', 'max_length']
success rate: 0/5
tensor shapes - states: torch.Size([2505, 56]), actions: torch.Size([2505, 9])
Creating ensembles (obs_dim=56, act_dim=9, hidden_dim=64)
Training transition models...
Transition model losses: ['7.3283', '7.1271', '7.5411', '7.4353', '6.7028']
Training reward models...
Reward model losses: ['0.0399', '0.1636', '0.1083', '0.5237', '0.2959']
Training state VAE models...
State VAE losses: ['321450.7213', '277170.8812', '314210.2275', '424300.1813', '405849.0837']
Training action VAE models...
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
nan detected in action vae training - skipping iteration
Action VAE losses: ['12042.2842', '10088.6689', '13507.6514', '15198.0957', '14081.4932']
CM score components:
transition disagreement: 0.4439
reward disagreement: 0.2676
state disagreement: 1.1921
action disagreement: nan
total CM score: nan
pose is complete. CM score: nan
Processing intervention 6/6: random
IntervenedCausalWorld created with random intervention
Evaluating CM score for random intervention...
Reset #1: random intervention applied (success: True)
episode 1: 501 steps, reward: 2.268
Reset #2: random intervention applied (success: True)
Traceback (most recent call last):
  File "meta_teacher_student.py", line 623, in <module>
    main()
  File "meta_teacher_student.py", line 585, in main
    S_teacher = get_teacher_state(student_model, args.task, INTERVENTIONS, device=device, seed=args.seed)
  File "meta_teacher_student.py", line 341, in get_teacher_state
    cm_score = evaluate_cm_score(intervened_env, student_model, device=device, intervention_type=intervention['type'])
  File "meta_teacher_student.py", line 175, in evaluate_cm_score
    act, _ = student_model.predict(obs, deterministic=True)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/base_class.py", line 562, in predict
    return self.policy.predict(observation, state, episode_start, deterministic)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/policies.py", line 338, in predict
    actions = self._predict(observation, deterministic=deterministic)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/policies.py", line 630, in _predict
    return self.get_distribution(observation).get_actions(deterministic=deterministic)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/policies.py", line 658, in get_distribution
    latent_pi = self.mlp_extractor.forward_actor(features)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/torch_layers.py", line 231, in forward_actor
    return self.policy_net(self.shared_net(features))
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
