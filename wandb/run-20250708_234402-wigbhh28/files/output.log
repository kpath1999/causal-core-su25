2025-07-08 23:44:04,419 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: goal
autocalc_cpdrl.py:282: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:230.)
  states = torch.tensor([d[0] for d in data], dtype=torch.float32).to(device)
2025-07-08 23:44:12,252 2217858 INFO   CM: 2.1113
2025-07-08 23:44:12,253 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: mass
2025-07-08 23:44:18,625 2217858 INFO   CM: 2.2314
2025-07-08 23:44:18,626 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: friction
2025-07-08 23:44:24,786 2217858 INFO   CM: 2.3691
2025-07-08 23:44:24,787 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: visual
2025-07-08 23:44:30,983 2217858 INFO   CM: 2.2086
2025-07-08 23:44:30,984 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: pose
2025-07-08 23:44:37,265 2217858 INFO   CM: 2.1335
2025-07-08 23:44:37,267 2217858 INFO [AutoCaLC-CPDRL] Evaluating intervention: random
2025-07-08 23:44:43,450 2217858 INFO   CM: 2.4088
2025-07-08 23:44:43,452 2217858 INFO
[AutoCaLC-CPDRL] Intervention ranking (by CM score):
2025-07-08 23:44:43,452 2217858 INFO   1. random | CM: 2.4088
2025-07-08 23:44:43,452 2217858 INFO   2. friction | CM: 2.3691
2025-07-08 23:44:43,453 2217858 INFO   3. mass | CM: 2.2314
2025-07-08 23:44:43,453 2217858 INFO   4. visual | CM: 2.2086
2025-07-08 23:44:43,453 2217858 INFO   5. pose | CM: 2.1335
2025-07-08 23:44:43,453 2217858 INFO   6. goal | CM: 2.1113
2025-07-08 23:44:43,454 2217858 INFO
[AutoCaLC-CPDRL] === Intervention 'random' just got applied (rank 1) ===
Logging to autocalc_cpdrl_logs/PPO_19
2025-07-08 23:44:44,255 2217858 INFO [AutoCaLC-CPDRL] Episode 1: reward=0.0505 (Intervention: random, Rank: 1)
[34m[1mwandb[0m: [33mWARNING[0m Step cannot be set when using tensorboard syncing. Please use `run.define_metric(...)` to define a custom metric to log your step values.
2025-07-08 23:44:44,849 2217858 INFO [AutoCaLC-CPDRL] Episode 2: reward=-0.0218 (Intervention: random, Rank: 1)
2025-07-08 23:44:45,465 2217858 INFO [AutoCaLC-CPDRL] Episode 3: reward=0.0662 (Intervention: random, Rank: 1)
2025-07-08 23:44:46,079 2217858 INFO [AutoCaLC-CPDRL] Episode 4: reward=0.0687 (Intervention: random, Rank: 1)
2025-07-08 23:44:46,709 2217858 INFO [AutoCaLC-CPDRL] Episode 5: reward=0.0619 (Intervention: random, Rank: 1)
2025-07-08 23:44:47,289 2217858 INFO [AutoCaLC-CPDRL] Episode 6: reward=0.0469 (Intervention: random, Rank: 1)
2025-07-08 23:44:47,930 2217858 INFO [AutoCaLC-CPDRL] Episode 7: reward=0.0784 (Intervention: random, Rank: 1)
2025-07-08 23:44:48,588 2217858 INFO [AutoCaLC-CPDRL] Episode 8: reward=0.0179 (Intervention: random, Rank: 1)
-----------------------------
| time/              |      |
|    fps             | 400  |
|    iterations      | 1    |
|    time_elapsed    | 5    |
|    total_timesteps | 2048 |
-----------------------------
2025-07-08 23:44:55,008 2217858 INFO [AutoCaLC-CPDRL] Episode 9: reward=0.0804 (Intervention: random, Rank: 1)
2025-07-08 23:44:55,862 2217858 INFO [AutoCaLC-CPDRL] Episode 10: reward=0.0133 (Intervention: random, Rank: 1)
2025-07-08 23:44:55,862 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0463
2025-07-08 23:44:56,680 2217858 INFO [AutoCaLC-CPDRL] Episode 11: reward=0.0484 (Intervention: random, Rank: 1)
2025-07-08 23:44:57,379 2217858 INFO [AutoCaLC-CPDRL] Episode 12: reward=0.0030 (Intervention: random, Rank: 1)
2025-07-08 23:44:57,979 2217858 INFO [AutoCaLC-CPDRL] Episode 13: reward=-0.0081 (Intervention: random, Rank: 1)
2025-07-08 23:44:58,547 2217858 INFO [AutoCaLC-CPDRL] Episode 14: reward=0.0579 (Intervention: random, Rank: 1)
2025-07-08 23:44:59,140 2217858 INFO [AutoCaLC-CPDRL] Episode 15: reward=0.0842 (Intervention: random, Rank: 1)
2025-07-08 23:44:59,772 2217858 INFO [AutoCaLC-CPDRL] Episode 16: reward=-0.0493 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 250         |
|    iterations           | 2           |
|    time_elapsed         | 16          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.037801716 |
|    clip_fraction        | 0.482       |
|    clip_range           | 0.2         |
|    entropy_loss         | -21.6       |
|    explained_variance   | 0.451       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.554      |
|    n_updates            | 1170        |
|    policy_gradient_loss | -0.116      |
|    std                  | 2.66        |
|    value_loss           | 0.0426      |
-----------------------------------------
2025-07-08 23:45:06,544 2217858 INFO [AutoCaLC-CPDRL] Episode 17: reward=0.1087 (Intervention: random, Rank: 1)
2025-07-08 23:45:07,119 2217858 INFO [AutoCaLC-CPDRL] Episode 18: reward=0.0382 (Intervention: random, Rank: 1)
2025-07-08 23:45:07,813 2217858 INFO [AutoCaLC-CPDRL] Episode 19: reward=0.0034 (Intervention: random, Rank: 1)
2025-07-08 23:45:08,538 2217858 INFO [AutoCaLC-CPDRL] Episode 20: reward=0.0496 (Intervention: random, Rank: 1)
2025-07-08 23:45:08,539 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0336
2025-07-08 23:45:09,249 2217858 INFO [AutoCaLC-CPDRL] Episode 21: reward=0.1006 (Intervention: random, Rank: 1)
2025-07-08 23:45:09,954 2217858 INFO [AutoCaLC-CPDRL] Episode 22: reward=0.0472 (Intervention: random, Rank: 1)
2025-07-08 23:45:10,620 2217858 INFO [AutoCaLC-CPDRL] Episode 23: reward=-0.0127 (Intervention: random, Rank: 1)
2025-07-08 23:45:11,210 2217858 INFO [AutoCaLC-CPDRL] Episode 24: reward=-0.0063 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 220         |
|    iterations           | 3           |
|    time_elapsed         | 27          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.047504127 |
|    clip_fraction        | 0.537       |
|    clip_range           | 0.2         |
|    entropy_loss         | -21.6       |
|    explained_variance   | 0.691       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.556      |
|    n_updates            | 1185        |
|    policy_gradient_loss | -0.113      |
|    std                  | 2.67        |
|    value_loss           | 0.0218      |
-----------------------------------------
2025-07-08 23:45:17,640 2217858 INFO [AutoCaLC-CPDRL] Episode 25: reward=0.0169 (Intervention: random, Rank: 1)
2025-07-08 23:45:18,268 2217858 INFO [AutoCaLC-CPDRL] Episode 26: reward=0.0620 (Intervention: random, Rank: 1)
2025-07-08 23:45:18,904 2217858 INFO [AutoCaLC-CPDRL] Episode 27: reward=0.0774 (Intervention: random, Rank: 1)
2025-07-08 23:45:19,574 2217858 INFO [AutoCaLC-CPDRL] Episode 28: reward=0.1118 (Intervention: random, Rank: 1)
2025-07-08 23:45:20,304 2217858 INFO [AutoCaLC-CPDRL] Episode 29: reward=0.0863 (Intervention: random, Rank: 1)
2025-07-08 23:45:20,980 2217858 INFO [AutoCaLC-CPDRL] Episode 30: reward=-0.0146 (Intervention: random, Rank: 1)
2025-07-08 23:45:20,981 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0469
2025-07-08 23:45:21,654 2217858 INFO [AutoCaLC-CPDRL] Episode 31: reward=-0.0069 (Intervention: random, Rank: 1)
2025-07-08 23:45:22,300 2217858 INFO [AutoCaLC-CPDRL] Episode 32: reward=-0.0523 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 209         |
|    iterations           | 4           |
|    time_elapsed         | 39          |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.043570876 |
|    clip_fraction        | 0.531       |
|    clip_range           | 0.2         |
|    entropy_loss         | -21.7       |
|    explained_variance   | 0.66        |
|    learning_rate        | 0.00025     |
|    loss                 | -0.533      |
|    n_updates            | 1200        |
|    policy_gradient_loss | -0.109      |
|    std                  | 2.69        |
|    value_loss           | 0.035       |
-----------------------------------------
2025-07-08 23:45:29,195 2217858 INFO [AutoCaLC-CPDRL] Episode 33: reward=-0.0239 (Intervention: random, Rank: 1)
2025-07-08 23:45:29,787 2217858 INFO [AutoCaLC-CPDRL] Episode 34: reward=0.0228 (Intervention: random, Rank: 1)
2025-07-08 23:45:30,358 2217858 INFO [AutoCaLC-CPDRL] Episode 35: reward=0.0191 (Intervention: random, Rank: 1)
2025-07-08 23:45:30,911 2217858 INFO [AutoCaLC-CPDRL] Episode 36: reward=-0.0259 (Intervention: random, Rank: 1)
2025-07-08 23:45:31,478 2217858 INFO [AutoCaLC-CPDRL] Episode 37: reward=0.0306 (Intervention: random, Rank: 1)
2025-07-08 23:45:32,121 2217858 INFO [AutoCaLC-CPDRL] Episode 38: reward=0.0196 (Intervention: random, Rank: 1)
2025-07-08 23:45:32,849 2217858 INFO [AutoCaLC-CPDRL] Episode 39: reward=0.0158 (Intervention: random, Rank: 1)
2025-07-08 23:45:33,605 2217858 INFO [AutoCaLC-CPDRL] Episode 40: reward=-0.0050 (Intervention: random, Rank: 1)
2025-07-08 23:45:33,605 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): -0.0006
-----------------------------------------
| time/                   |             |
|    fps                  | 202         |
|    iterations           | 5           |
|    time_elapsed         | 50          |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.049657904 |
|    clip_fraction        | 0.512       |
|    clip_range           | 0.2         |
|    entropy_loss         | -21.7       |
|    explained_variance   | 0.638       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.525      |
|    n_updates            | 1215        |
|    policy_gradient_loss | -0.107      |
|    std                  | 2.71        |
|    value_loss           | 0.0431      |
-----------------------------------------
2025-07-08 23:45:44,244 2217858 INFO [AutoCaLC-CPDRL] Timesteps: 10000, Current CM: 2.1505, Reduction: 10.72% (No reduction count: 0)
2025-07-08 23:45:44,245 2217858 INFO [AutoCaLC-CPDRL] CM reduction insufficient (< 30%), continuing training.
[34m[1mwandb[0m: [33mWARNING[0m When using several event log directories, please call `wandb.tensorboard.patch(root_logdir="...")` before `wandb.init`
Logging to autocalc_cpdrl_logs/PPO_20
2025-07-08 23:45:44,963 2217858 INFO [AutoCaLC-CPDRL] Episode 1: reward=0.0782 (Intervention: random, Rank: 1)
2025-07-08 23:45:45,667 2217858 INFO [AutoCaLC-CPDRL] Episode 2: reward=0.0366 (Intervention: random, Rank: 1)
2025-07-08 23:45:46,378 2217858 INFO [AutoCaLC-CPDRL] Episode 3: reward=0.0577 (Intervention: random, Rank: 1)
2025-07-08 23:45:47,096 2217858 INFO [AutoCaLC-CPDRL] Episode 4: reward=0.0393 (Intervention: random, Rank: 1)
2025-07-08 23:45:47,779 2217858 INFO [AutoCaLC-CPDRL] Episode 5: reward=0.0734 (Intervention: random, Rank: 1)
2025-07-08 23:45:48,400 2217858 INFO [AutoCaLC-CPDRL] Episode 6: reward=0.0529 (Intervention: random, Rank: 1)
2025-07-08 23:45:48,972 2217858 INFO [AutoCaLC-CPDRL] Episode 7: reward=0.1002 (Intervention: random, Rank: 1)
2025-07-08 23:45:49,539 2217858 INFO [AutoCaLC-CPDRL] Episode 8: reward=-0.0087 (Intervention: random, Rank: 1)
-----------------------------
| time/              |      |
|    fps             | 382  |
|    iterations      | 1    |
|    time_elapsed    | 5    |
|    total_timesteps | 2048 |
-----------------------------
2025-07-08 23:45:56,807 2217858 INFO [AutoCaLC-CPDRL] Episode 9: reward=0.0938 (Intervention: random, Rank: 1)
2025-07-08 23:45:57,424 2217858 INFO [AutoCaLC-CPDRL] Episode 10: reward=-0.0124 (Intervention: random, Rank: 1)
2025-07-08 23:45:57,424 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0511
2025-07-08 23:45:57,991 2217858 INFO [AutoCaLC-CPDRL] Episode 11: reward=-0.0793 (Intervention: random, Rank: 1)
2025-07-08 23:45:58,580 2217858 INFO [AutoCaLC-CPDRL] Episode 12: reward=0.0031 (Intervention: random, Rank: 1)
2025-07-08 23:45:59,294 2217858 INFO [AutoCaLC-CPDRL] Episode 13: reward=0.0000 (Intervention: random, Rank: 1)
2025-07-08 23:46:00,223 2217858 INFO [AutoCaLC-CPDRL] Episode 14: reward=0.0119 (Intervention: random, Rank: 1)
2025-07-08 23:46:01,564 2217858 INFO [AutoCaLC-CPDRL] Episode 15: reward=0.1610 (Intervention: random, Rank: 1)
2025-07-08 23:46:02,575 2217858 INFO [AutoCaLC-CPDRL] Episode 16: reward=-0.0640 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 221         |
|    iterations           | 2           |
|    time_elapsed         | 18          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.040136606 |
|    clip_fraction        | 0.514       |
|    clip_range           | 0.2         |
|    entropy_loss         | -21.9       |
|    explained_variance   | 0.743       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.555      |
|    n_updates            | 1245        |
|    policy_gradient_loss | -0.109      |
|    std                  | 2.77        |
|    value_loss           | 0.0229      |
-----------------------------------------
2025-07-08 23:46:10,355 2217858 INFO [AutoCaLC-CPDRL] Episode 17: reward=-0.0486 (Intervention: random, Rank: 1)
2025-07-08 23:46:10,912 2217858 INFO [AutoCaLC-CPDRL] Episode 18: reward=-0.0203 (Intervention: random, Rank: 1)
2025-07-08 23:46:11,485 2217858 INFO [AutoCaLC-CPDRL] Episode 19: reward=-0.0512 (Intervention: random, Rank: 1)
2025-07-08 23:46:12,040 2217858 INFO [AutoCaLC-CPDRL] Episode 20: reward=0.0950 (Intervention: random, Rank: 1)
2025-07-08 23:46:12,041 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0008
2025-07-08 23:46:12,598 2217858 INFO [AutoCaLC-CPDRL] Episode 21: reward=0.1165 (Intervention: random, Rank: 1)
2025-07-08 23:46:13,598 2217858 INFO [AutoCaLC-CPDRL] Episode 22: reward=0.0479 (Intervention: random, Rank: 1)
2025-07-08 23:46:14,705 2217858 INFO [AutoCaLC-CPDRL] Episode 23: reward=0.0004 (Intervention: random, Rank: 1)
2025-07-08 23:46:15,792 2217858 INFO [AutoCaLC-CPDRL] Episode 24: reward=0.0109 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 192         |
|    iterations           | 3           |
|    time_elapsed         | 31          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.047597766 |
|    clip_fraction        | 0.566       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22         |
|    explained_variance   | 0.799       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.571      |
|    n_updates            | 1260        |
|    policy_gradient_loss | -0.118      |
|    std                  | 2.78        |
|    value_loss           | 0.0184      |
-----------------------------------------
2025-07-08 23:46:22,948 2217858 INFO [AutoCaLC-CPDRL] Episode 25: reward=-0.0324 (Intervention: random, Rank: 1)
2025-07-08 23:46:23,740 2217858 INFO [AutoCaLC-CPDRL] Episode 26: reward=-0.0415 (Intervention: random, Rank: 1)
2025-07-08 23:46:24,332 2217858 INFO [AutoCaLC-CPDRL] Episode 27: reward=0.1131 (Intervention: random, Rank: 1)
2025-07-08 23:46:24,895 2217858 INFO [AutoCaLC-CPDRL] Episode 28: reward=0.1295 (Intervention: random, Rank: 1)
2025-07-08 23:46:25,464 2217858 INFO [AutoCaLC-CPDRL] Episode 29: reward=0.0215 (Intervention: random, Rank: 1)
2025-07-08 23:46:26,025 2217858 INFO [AutoCaLC-CPDRL] Episode 30: reward=0.0234 (Intervention: random, Rank: 1)
2025-07-08 23:46:26,026 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0389
2025-07-08 23:46:26,657 2217858 INFO [AutoCaLC-CPDRL] Episode 31: reward=-0.0624 (Intervention: random, Rank: 1)
2025-07-08 23:46:27,388 2217858 INFO [AutoCaLC-CPDRL] Episode 32: reward=-0.0346 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 188         |
|    iterations           | 4           |
|    time_elapsed         | 43          |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.054170035 |
|    clip_fraction        | 0.559       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22         |
|    explained_variance   | 0.609       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.559      |
|    n_updates            | 1275        |
|    policy_gradient_loss | -0.112      |
|    std                  | 2.8         |
|    value_loss           | 0.0213      |
-----------------------------------------
2025-07-08 23:46:33,890 2217858 INFO [AutoCaLC-CPDRL] Episode 33: reward=-0.0093 (Intervention: random, Rank: 1)
2025-07-08 23:46:34,764 2217858 INFO [AutoCaLC-CPDRL] Episode 34: reward=0.0516 (Intervention: random, Rank: 1)
2025-07-08 23:46:35,532 2217858 INFO [AutoCaLC-CPDRL] Episode 35: reward=0.0688 (Intervention: random, Rank: 1)
2025-07-08 23:46:36,201 2217858 INFO [AutoCaLC-CPDRL] Episode 36: reward=-0.0293 (Intervention: random, Rank: 1)
2025-07-08 23:46:36,777 2217858 INFO [AutoCaLC-CPDRL] Episode 37: reward=0.0196 (Intervention: random, Rank: 1)
2025-07-08 23:46:37,373 2217858 INFO [AutoCaLC-CPDRL] Episode 38: reward=0.0608 (Intervention: random, Rank: 1)
2025-07-08 23:46:38,003 2217858 INFO [AutoCaLC-CPDRL] Episode 39: reward=-0.0046 (Intervention: random, Rank: 1)
2025-07-08 23:46:38,648 2217858 INFO [AutoCaLC-CPDRL] Episode 40: reward=-0.0986 (Intervention: random, Rank: 1)
2025-07-08 23:46:38,648 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): -0.0038
-----------------------------------------
| time/                   |             |
|    fps                  | 186         |
|    iterations           | 5           |
|    time_elapsed         | 54          |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.052607775 |
|    clip_fraction        | 0.543       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.1       |
|    explained_variance   | 0.501       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.545      |
|    n_updates            | 1290        |
|    policy_gradient_loss | -0.103      |
|    std                  | 2.82        |
|    value_loss           | 0.0477      |
-----------------------------------------
2025-07-08 23:46:49,762 2217858 INFO [AutoCaLC-CPDRL] Timesteps: 20000, Current CM: 2.1475, Reduction: 10.85% (No reduction count: 1)
2025-07-08 23:46:49,763 2217858 INFO [AutoCaLC-CPDRL] CM reduction insufficient (< 30%), continuing training.
[34m[1mwandb[0m: [33mWARNING[0m When using several event log directories, please call `wandb.tensorboard.patch(root_logdir="...")` before `wandb.init`
Logging to autocalc_cpdrl_logs/PPO_21
2025-07-08 23:46:50,471 2217858 INFO [AutoCaLC-CPDRL] Episode 1: reward=0.0449 (Intervention: random, Rank: 1)
2025-07-08 23:46:51,036 2217858 INFO [AutoCaLC-CPDRL] Episode 2: reward=0.0346 (Intervention: random, Rank: 1)
2025-07-08 23:46:51,600 2217858 INFO [AutoCaLC-CPDRL] Episode 3: reward=-0.0088 (Intervention: random, Rank: 1)
2025-07-08 23:46:52,175 2217858 INFO [AutoCaLC-CPDRL] Episode 4: reward=0.0428 (Intervention: random, Rank: 1)
2025-07-08 23:46:52,832 2217858 INFO [AutoCaLC-CPDRL] Episode 5: reward=0.0796 (Intervention: random, Rank: 1)
2025-07-08 23:46:53,483 2217858 INFO [AutoCaLC-CPDRL] Episode 6: reward=0.0260 (Intervention: random, Rank: 1)
2025-07-08 23:46:54,138 2217858 INFO [AutoCaLC-CPDRL] Episode 7: reward=0.0669 (Intervention: random, Rank: 1)
2025-07-08 23:46:54,755 2217858 INFO [AutoCaLC-CPDRL] Episode 8: reward=-0.0070 (Intervention: random, Rank: 1)
-----------------------------
| time/              |      |
|    fps             | 405  |
|    iterations      | 1    |
|    time_elapsed    | 5    |
|    total_timesteps | 2048 |
-----------------------------
2025-07-08 23:47:00,822 2217858 INFO [AutoCaLC-CPDRL] Episode 9: reward=0.0393 (Intervention: random, Rank: 1)
2025-07-08 23:47:01,504 2217858 INFO [AutoCaLC-CPDRL] Episode 10: reward=-0.0212 (Intervention: random, Rank: 1)
2025-07-08 23:47:01,504 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0297
2025-07-08 23:47:02,144 2217858 INFO [AutoCaLC-CPDRL] Episode 11: reward=-0.0025 (Intervention: random, Rank: 1)
2025-07-08 23:47:02,788 2217858 INFO [AutoCaLC-CPDRL] Episode 12: reward=-0.0287 (Intervention: random, Rank: 1)
2025-07-08 23:47:03,443 2217858 INFO [AutoCaLC-CPDRL] Episode 13: reward=-0.0293 (Intervention: random, Rank: 1)
2025-07-08 23:47:04,042 2217858 INFO [AutoCaLC-CPDRL] Episode 14: reward=0.0274 (Intervention: random, Rank: 1)
2025-07-08 23:47:04,678 2217858 INFO [AutoCaLC-CPDRL] Episode 15: reward=0.0880 (Intervention: random, Rank: 1)
2025-07-08 23:47:05,337 2217858 INFO [AutoCaLC-CPDRL] Episode 16: reward=-0.0391 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 260         |
|    iterations           | 2           |
|    time_elapsed         | 15          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.041452702 |
|    clip_fraction        | 0.517       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.3       |
|    explained_variance   | 0.713       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.567      |
|    n_updates            | 1320        |
|    policy_gradient_loss | -0.11       |
|    std                  | 2.88        |
|    value_loss           | 0.0303      |
-----------------------------------------
2025-07-08 23:47:11,787 2217858 INFO [AutoCaLC-CPDRL] Episode 17: reward=0.0103 (Intervention: random, Rank: 1)
2025-07-08 23:47:12,507 2217858 INFO [AutoCaLC-CPDRL] Episode 18: reward=-0.0628 (Intervention: random, Rank: 1)
2025-07-08 23:47:13,231 2217858 INFO [AutoCaLC-CPDRL] Episode 19: reward=-0.0600 (Intervention: random, Rank: 1)
2025-07-08 23:47:13,898 2217858 INFO [AutoCaLC-CPDRL] Episode 20: reward=0.0318 (Intervention: random, Rank: 1)
2025-07-08 23:47:13,899 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): -0.0065
2025-07-08 23:47:14,510 2217858 INFO [AutoCaLC-CPDRL] Episode 21: reward=-0.0072 (Intervention: random, Rank: 1)
2025-07-08 23:47:15,085 2217858 INFO [AutoCaLC-CPDRL] Episode 22: reward=0.0323 (Intervention: random, Rank: 1)
2025-07-08 23:47:15,655 2217858 INFO [AutoCaLC-CPDRL] Episode 23: reward=-0.0040 (Intervention: random, Rank: 1)
2025-07-08 23:47:16,209 2217858 INFO [AutoCaLC-CPDRL] Episode 24: reward=0.0218 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 230         |
|    iterations           | 3           |
|    time_elapsed         | 26          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.053850926 |
|    clip_fraction        | 0.577       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.4       |
|    explained_variance   | 0.807       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.564      |
|    n_updates            | 1335        |
|    policy_gradient_loss | -0.113      |
|    std                  | 2.93        |
|    value_loss           | 0.0158      |
-----------------------------------------
2025-07-08 23:47:22,518 2217858 INFO [AutoCaLC-CPDRL] Episode 25: reward=-0.0298 (Intervention: random, Rank: 1)
2025-07-08 23:47:23,226 2217858 INFO [AutoCaLC-CPDRL] Episode 26: reward=0.0193 (Intervention: random, Rank: 1)
2025-07-08 23:47:23,960 2217858 INFO [AutoCaLC-CPDRL] Episode 27: reward=0.0489 (Intervention: random, Rank: 1)
2025-07-08 23:47:24,679 2217858 INFO [AutoCaLC-CPDRL] Episode 28: reward=-0.0118 (Intervention: random, Rank: 1)
2025-07-08 23:47:25,379 2217858 INFO [AutoCaLC-CPDRL] Episode 29: reward=-0.0298 (Intervention: random, Rank: 1)
2025-07-08 23:47:25,998 2217858 INFO [AutoCaLC-CPDRL] Episode 30: reward=0.0442 (Intervention: random, Rank: 1)
2025-07-08 23:47:25,999 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0084
2025-07-08 23:47:26,588 2217858 INFO [AutoCaLC-CPDRL] Episode 31: reward=-0.0938 (Intervention: random, Rank: 1)
2025-07-08 23:47:27,200 2217858 INFO [AutoCaLC-CPDRL] Episode 32: reward=-0.0530 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 217         |
|    iterations           | 4           |
|    time_elapsed         | 37          |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.053299762 |
|    clip_fraction        | 0.591       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.5       |
|    explained_variance   | 0.692       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.563      |
|    n_updates            | 1350        |
|    policy_gradient_loss | -0.109      |
|    std                  | 2.97        |
|    value_loss           | 0.0215      |
-----------------------------------------
2025-07-08 23:47:33,545 2217858 INFO [AutoCaLC-CPDRL] Episode 33: reward=-0.0448 (Intervention: random, Rank: 1)
2025-07-08 23:47:34,125 2217858 INFO [AutoCaLC-CPDRL] Episode 34: reward=0.0513 (Intervention: random, Rank: 1)
2025-07-08 23:47:34,744 2217858 INFO [AutoCaLC-CPDRL] Episode 35: reward=0.0108 (Intervention: random, Rank: 1)
2025-07-08 23:47:35,448 2217858 INFO [AutoCaLC-CPDRL] Episode 36: reward=0.0282 (Intervention: random, Rank: 1)
2025-07-08 23:47:36,210 2217858 INFO [AutoCaLC-CPDRL] Episode 37: reward=0.0501 (Intervention: random, Rank: 1)
2025-07-08 23:47:37,003 2217858 INFO [AutoCaLC-CPDRL] Episode 38: reward=0.0369 (Intervention: random, Rank: 1)
2025-07-08 23:47:37,730 2217858 INFO [AutoCaLC-CPDRL] Episode 39: reward=0.0293 (Intervention: random, Rank: 1)
2025-07-08 23:47:38,377 2217858 INFO [AutoCaLC-CPDRL] Episode 40: reward=-0.0086 (Intervention: random, Rank: 1)
2025-07-08 23:47:38,377 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0006
---------------------------------------
| time/                   |           |
|    fps                  | 208       |
|    iterations           | 5         |
|    time_elapsed         | 49        |
|    total_timesteps      | 10240     |
| train/                  |           |
|    approx_kl            | 0.0661464 |
|    clip_fraction        | 0.505     |
|    clip_range           | 0.2       |
|    entropy_loss         | -22.6     |
|    explained_variance   | 0.452     |
|    learning_rate        | 0.00025   |
|    loss                 | -0.511    |
|    n_updates            | 1365      |
|    policy_gradient_loss | -0.0834   |
|    std                  | 3         |
|    value_loss           | 0.0781    |
---------------------------------------
2025-07-08 23:47:49,956 2217858 INFO [AutoCaLC-CPDRL] Timesteps: 30000, Current CM: 2.1473, Reduction: 10.86% (No reduction count: 2)
2025-07-08 23:47:49,957 2217858 INFO [AutoCaLC-CPDRL] CM reduction insufficient (< 30%), continuing training.
[34m[1mwandb[0m: [33mWARNING[0m When using several event log directories, please call `wandb.tensorboard.patch(root_logdir="...")` before `wandb.init`
Logging to autocalc_cpdrl_logs/PPO_22
2025-07-08 23:47:51,243 2217858 INFO [AutoCaLC-CPDRL] Episode 1: reward=0.1019 (Intervention: random, Rank: 1)
2025-07-08 23:47:52,014 2217858 INFO [AutoCaLC-CPDRL] Episode 2: reward=0.0632 (Intervention: random, Rank: 1)
2025-07-08 23:47:52,633 2217858 INFO [AutoCaLC-CPDRL] Episode 3: reward=0.0064 (Intervention: random, Rank: 1)
2025-07-08 23:47:53,221 2217858 INFO [AutoCaLC-CPDRL] Episode 4: reward=0.0437 (Intervention: random, Rank: 1)
2025-07-08 23:47:53,860 2217858 INFO [AutoCaLC-CPDRL] Episode 5: reward=0.0525 (Intervention: random, Rank: 1)
2025-07-08 23:47:54,639 2217858 INFO [AutoCaLC-CPDRL] Episode 6: reward=-0.1156 (Intervention: random, Rank: 1)
2025-07-08 23:47:55,503 2217858 INFO [AutoCaLC-CPDRL] Episode 7: reward=0.1169 (Intervention: random, Rank: 1)
2025-07-08 23:47:56,262 2217858 INFO [AutoCaLC-CPDRL] Episode 8: reward=0.0212 (Intervention: random, Rank: 1)
-----------------------------
| time/              |      |
|    fps             | 332  |
|    iterations      | 1    |
|    time_elapsed    | 6    |
|    total_timesteps | 2048 |
-----------------------------
2025-07-08 23:48:01,781 2217858 INFO [AutoCaLC-CPDRL] Episode 9: reward=0.0810 (Intervention: random, Rank: 1)
2025-07-08 23:48:02,492 2217858 INFO [AutoCaLC-CPDRL] Episode 10: reward=0.0223 (Intervention: random, Rank: 1)
2025-07-08 23:48:02,493 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0394
2025-07-08 23:48:03,109 2217858 INFO [AutoCaLC-CPDRL] Episode 11: reward=0.0101 (Intervention: random, Rank: 1)
2025-07-08 23:48:03,680 2217858 INFO [AutoCaLC-CPDRL] Episode 12: reward=0.0153 (Intervention: random, Rank: 1)
2025-07-08 23:48:04,244 2217858 INFO [AutoCaLC-CPDRL] Episode 13: reward=-0.0022 (Intervention: random, Rank: 1)
2025-07-08 23:48:04,846 2217858 INFO [AutoCaLC-CPDRL] Episode 14: reward=0.0539 (Intervention: random, Rank: 1)
2025-07-08 23:48:05,546 2217858 INFO [AutoCaLC-CPDRL] Episode 15: reward=0.0427 (Intervention: random, Rank: 1)
2025-07-08 23:48:06,416 2217858 INFO [AutoCaLC-CPDRL] Episode 16: reward=0.0221 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 249         |
|    iterations           | 2           |
|    time_elapsed         | 16          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.055956297 |
|    clip_fraction        | 0.541       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.8       |
|    explained_variance   | 0.54        |
|    learning_rate        | 0.00025     |
|    loss                 | -0.571      |
|    n_updates            | 1395        |
|    policy_gradient_loss | -0.108      |
|    std                  | 3.06        |
|    value_loss           | 0.0449      |
-----------------------------------------
2025-07-08 23:48:13,132 2217858 INFO [AutoCaLC-CPDRL] Episode 17: reward=-0.0121 (Intervention: random, Rank: 1)
2025-07-08 23:48:13,807 2217858 INFO [AutoCaLC-CPDRL] Episode 18: reward=0.0352 (Intervention: random, Rank: 1)
2025-07-08 23:48:14,407 2217858 INFO [AutoCaLC-CPDRL] Episode 19: reward=0.0109 (Intervention: random, Rank: 1)
2025-07-08 23:48:14,974 2217858 INFO [AutoCaLC-CPDRL] Episode 20: reward=0.0213 (Intervention: random, Rank: 1)
2025-07-08 23:48:14,974 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0197
2025-07-08 23:48:15,547 2217858 INFO [AutoCaLC-CPDRL] Episode 21: reward=0.0676 (Intervention: random, Rank: 1)
2025-07-08 23:48:16,126 2217858 INFO [AutoCaLC-CPDRL] Episode 22: reward=0.0591 (Intervention: random, Rank: 1)
2025-07-08 23:48:16,836 2217858 INFO [AutoCaLC-CPDRL] Episode 23: reward=-0.0322 (Intervention: random, Rank: 1)
2025-07-08 23:48:17,558 2217858 INFO [AutoCaLC-CPDRL] Episode 24: reward=-0.0293 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 222         |
|    iterations           | 3           |
|    time_elapsed         | 27          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.055393033 |
|    clip_fraction        | 0.563       |
|    clip_range           | 0.2         |
|    entropy_loss         | -22.9       |
|    explained_variance   | 0.684       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.565      |
|    n_updates            | 1410        |
|    policy_gradient_loss | -0.103      |
|    std                  | 3.11        |
|    value_loss           | 0.0344      |
-----------------------------------------
2025-07-08 23:48:24,119 2217858 INFO [AutoCaLC-CPDRL] Episode 25: reward=-0.0415 (Intervention: random, Rank: 1)
2025-07-08 23:48:24,980 2217858 INFO [AutoCaLC-CPDRL] Episode 26: reward=-0.0031 (Intervention: random, Rank: 1)
2025-07-08 23:48:25,622 2217858 INFO [AutoCaLC-CPDRL] Episode 27: reward=0.0719 (Intervention: random, Rank: 1)
2025-07-08 23:48:26,219 2217858 INFO [AutoCaLC-CPDRL] Episode 28: reward=0.0618 (Intervention: random, Rank: 1)
2025-07-08 23:48:26,792 2217858 INFO [AutoCaLC-CPDRL] Episode 29: reward=0.0557 (Intervention: random, Rank: 1)
2025-07-08 23:48:27,414 2217858 INFO [AutoCaLC-CPDRL] Episode 30: reward=-0.0460 (Intervention: random, Rank: 1)
2025-07-08 23:48:27,415 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0164
2025-07-08 23:48:28,095 2217858 INFO [AutoCaLC-CPDRL] Episode 31: reward=0.0074 (Intervention: random, Rank: 1)
2025-07-08 23:48:28,958 2217858 INFO [AutoCaLC-CPDRL] Episode 32: reward=-0.0241 (Intervention: random, Rank: 1)
-----------------------------------------
| time/                   |             |
|    fps                  | 208         |
|    iterations           | 4           |
|    time_elapsed         | 39          |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.052383255 |
|    clip_fraction        | 0.528       |
|    clip_range           | 0.2         |
|    entropy_loss         | -23         |
|    explained_variance   | 0.719       |
|    learning_rate        | 0.00025     |
|    loss                 | -0.532      |
|    n_updates            | 1425        |
|    policy_gradient_loss | -0.0928     |
|    std                  | 3.14        |
|    value_loss           | 0.0713      |
-----------------------------------------
2025-07-08 23:48:35,379 2217858 INFO [AutoCaLC-CPDRL] Episode 33: reward=-0.0420 (Intervention: random, Rank: 1)
2025-07-08 23:48:36,114 2217858 INFO [AutoCaLC-CPDRL] Episode 34: reward=0.0655 (Intervention: random, Rank: 1)
2025-07-08 23:48:36,779 2217858 INFO [AutoCaLC-CPDRL] Episode 35: reward=-0.0864 (Intervention: random, Rank: 1)
2025-07-08 23:48:37,396 2217858 INFO [AutoCaLC-CPDRL] Episode 36: reward=-0.0203 (Intervention: random, Rank: 1)
2025-07-08 23:48:37,957 2217858 INFO [AutoCaLC-CPDRL] Episode 37: reward=0.0308 (Intervention: random, Rank: 1)
2025-07-08 23:48:38,552 2217858 INFO [AutoCaLC-CPDRL] Episode 38: reward=0.0610 (Intervention: random, Rank: 1)
2025-07-08 23:48:39,209 2217858 INFO [AutoCaLC-CPDRL] Episode 39: reward=0.0291 (Intervention: random, Rank: 1)
2025-07-08 23:48:39,906 2217858 INFO [AutoCaLC-CPDRL] Episode 40: reward=0.0220 (Intervention: random, Rank: 1)
2025-07-08 23:48:39,907 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0043
----------------------------------------
| time/                   |            |
|    fps                  | 203        |
|    iterations           | 5          |
|    time_elapsed         | 50         |
|    total_timesteps      | 10240      |
| train/                  |            |
|    approx_kl            | 0.06776641 |
|    clip_fraction        | 0.591      |
|    clip_range           | 0.2        |
|    entropy_loss         | -23.1      |
|    explained_variance   | 0.683      |
|    learning_rate        | 0.00025    |
|    loss                 | -0.556     |
|    n_updates            | 1440       |
|    policy_gradient_loss | -0.105     |
|    std                  | 3.19       |
|    value_loss           | 0.0683     |
----------------------------------------
2025-07-08 23:48:50,220 2217858 INFO [AutoCaLC-CPDRL] Timesteps: 40000, Current CM: 2.1488, Reduction: 10.79% (No reduction count: 3)
2025-07-08 23:48:50,221 2217858 INFO [AutoCaLC-CPDRL] CM reduction insufficient (< 30%), continuing training.
[34m[1mwandb[0m: [33mWARNING[0m When using several event log directories, please call `wandb.tensorboard.patch(root_logdir="...")` before `wandb.init`
Logging to autocalc_cpdrl_logs/PPO_23
2025-07-08 23:48:52,370 2217858 INFO [AutoCaLC-CPDRL] Episode 1: reward=-0.0129 (Intervention: random, Rank: 1)
2025-07-08 23:48:53,143 2217858 INFO [AutoCaLC-CPDRL] Episode 2: reward=0.0524 (Intervention: random, Rank: 1)
2025-07-08 23:48:53,855 2217858 INFO [AutoCaLC-CPDRL] Episode 3: reward=0.0174 (Intervention: random, Rank: 1)
2025-07-08 23:48:54,499 2217858 INFO [AutoCaLC-CPDRL] Episode 4: reward=0.0598 (Intervention: random, Rank: 1)
2025-07-08 23:48:55,099 2217858 INFO [AutoCaLC-CPDRL] Episode 5: reward=0.1131 (Intervention: random, Rank: 1)
2025-07-08 23:48:55,679 2217858 INFO [AutoCaLC-CPDRL] Episode 6: reward=0.0202 (Intervention: random, Rank: 1)
2025-07-08 23:48:56,294 2217858 INFO [AutoCaLC-CPDRL] Episode 7: reward=-0.0458 (Intervention: random, Rank: 1)
2025-07-08 23:48:56,952 2217858 INFO [AutoCaLC-CPDRL] Episode 8: reward=0.0281 (Intervention: random, Rank: 1)
-----------------------------
| time/              |      |
|    fps             | 354  |
|    iterations      | 1    |
|    time_elapsed    | 5    |
|    total_timesteps | 2048 |
-----------------------------
2025-07-08 23:49:03,478 2217858 INFO [AutoCaLC-CPDRL] Episode 9: reward=0.0630 (Intervention: random, Rank: 1)
2025-07-08 23:49:04,083 2217858 INFO [AutoCaLC-CPDRL] Episode 10: reward=0.0231 (Intervention: random, Rank: 1)
2025-07-08 23:49:04,084 2217858 INFO [AutoCaLC-CPDRL] Mean reward (last 10): 0.0318
2025-07-08 23:49:04,732 2217858 INFO [AutoCaLC-CPDRL] Episode 11: reward=-0.0173 (Intervention: random, Rank: 1)
2025-07-08 23:49:05,391 2217858 INFO [AutoCaLC-CPDRL] Episode 12: reward=0.0368 (Intervention: random, Rank: 1)
2025-07-08 23:49:06,074 2217858 INFO [AutoCaLC-CPDRL] Episode 13: reward=-0.0190 (Intervention: random, Rank: 1)
Traceback (most recent call last):
  File "autocalc_cpdrl.py", line 558, in <module>
  File "autocalc_cpdrl.py", line 527, in main
    )
  File "autocalc_cpdrl.py", line 398, in ppo_train_on_intervention
    model.learn(total_timesteps=timesteps, callback=callback)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/ppo/ppo.py", line 308, in learn
    reset_num_timesteps=reset_num_timesteps,
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 250, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 207, in collect_rollouts
    rollout_buffer.add(self._last_obs, actions, rewards, self._last_episode_starts, values, log_probs)
  File "/home/kpatherya3/anaconda3/envs/causal_env/lib/python3.7/site-packages/stable_baselines3/common/buffers.py", line 432, in add
    self.values[self.pos] = value.clone().cpu().numpy().flatten()
KeyboardInterrupt
